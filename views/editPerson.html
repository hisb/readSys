<!DOCTYPE html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title><%= title %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Free HTML5 Template by FREEHTML5"/>
    <meta name="keywords" content="free html5, free template, free bootstrap, html5, css3, mobile first, responsive"/>


    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="favicon.ico">
    <!-- Google Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Playfair+Display:400,700,400italic|Roboto:400,300,700'
          rel='stylesheet' type='text/css'>
    <!-- Animate -->
    <link rel="stylesheet" href="stylesheets/animate.css">
    <!-- Icomoon -->
    <link rel="stylesheet" href="stylesheets/icomoon.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="stylesheets/bootstrap.min.css">

    <link rel="stylesheet" href="stylesheets/style2.css">

    <link rel="stylesheet" href="stylesheets/style.css">

    <link rel="stylesheet" href="stylesheets/input.css">
    <!-- <link rel="stylesheet" href="stylesheets/component.css"> -->


    <!-- Modernizr JS -->
    <script src="javascripts/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <style>
        #filePerson { display: inline-block; width: 50%; margin: 0 auto; border: none; opacity: 0 }
        .uploadPic { position: absolute; top: 0; left: 50%; width: 50%; margin-left: -25%; z-index: -1 }
        .imgSize { width: 200px; height: 200px; border-radius: 100%; } 
    </style>
</head>
<body>
<!-- END #fh5co-offcanvas -->
<header id="fh5co-header">

    <div class="container-fluid">

        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo"><a href="home">编辑资料</a></h1>
            </div>

        </div>

    </div>

</header>
<div class="copyrights">Collect from <a href="http://www.cssmoban.com/">企业网站模板</a></div>
<!-- END #fh5co-header -->
<div class="container-fluid">
    <div class="row fh5co-post-entry" style='width:40%; margin: 0 auto'>
        <div class='' style='font-size:20px'>
				<span class="input input--hoshi" style='text-align: center; position: relative'>
                    <form action="/avatarUpload" method="post" enctype="multipart/form-data">
                        <input type="file" name="avatar" id='filePerson'><br>
                    </form>
                    <input type="hidden" value="" id="avatarImgSrc" />
					<a class = 'uploadPic'><i class='glyphicon glyphicon-upload'></i>上传图像</a></br>
                    <img id='personPhoto' src='' class = 'imgSize'/>
				</span>
				<span class="input input--hoshi">
					<input class="input__field input__field--hoshi" type="password" id="password"/>
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="password">
                        <span class="input__label-content input__label-content--hoshi">密码</span>
                    </label>
				</span>
				<span class="input input--hoshi">
					<input class="input__field input__field--hoshi" type="text" id="nick"/>
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="nick">
                        <span class="input__label-content input__label-content--hoshi">昵称</span>
                    </label>
				</span>	
				<span class="input input--hoshi">
					<input class="input__field input__field--hoshi" type="text" id="email"/>
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="email">
                        <span class="input__label-content input__label-content--hoshi">邮箱</span>
                    </label>
				</span>
				<span class="input input--hoshi">
					<input class="input__field input__field--hoshi" type="text" id="phone"/>
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="phone">
                        <span class="input__label-content input__label-content--hoshi">手机号</span>
                    </label>
				</span>	
				<span class="input input--hoshi">
					<input class="input__field input__field--hoshi" type="text" id="address"/>
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="address">
                        <span class="input__label-content input__label-content--hoshi">地址</span>
                    </label>
				</span>
				<span class="input input--hoshi">
					<textarea class="input__field input__field--hoshi" type="text" id="desc" required rows='5'
                              style='resize: none'></textarea>
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="desc">
                        <span class="input__label-content input__label-content--hoshi">个人简介</span>
                    </label>
				</span>
				<span style='display: block; margin: 40px 0 30px'>
					<a style='display: inline-block; line-height: 40px; width: 100%; text-align: center; border: 2px solid #ddd; border-radius: 20px'
                       id='savePerson'>保存</a>
				</span>
        </div>
    </div>

</div>

<footer id="fh5co-footer">
    <p>
        <small>&copy; 2016. Magazine Free HTML5. All Rights Reserverd. <br> More Templates <a
                href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a
                href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a></small>
    </p>
</footer>


<!-- jQuery -->
<script src="javascripts/jquery-1.11.1.min.js"></script>
<!-- jQuery Easing -->
<script src="javascripts/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="javascripts/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="javascripts/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="javascripts/main.js"></script>

<script src="javascripts/home.js"></script>

<script src="javascripts/input.js"></script>

<script src="javascripts/jquery-form.js"></script>

<script>
    $(function () {
        //渲染用户信息
        $.get("/userInfo", function (data) {
            var data = data.data;
            $("#personPhoto").attr("src",data.imgSrc);
            $("#avatarImgSrc").val(data.imgSrc);
            $('#password').val(data.password);
            $('#password').parent('span').addClass('input--filled');
            $('#nick').val(data.nick);
            $('#nick').parent('span').addClass('input--filled');
            $('#email').val(data.email);
            $('#email').parent('span').addClass('input--filled');
            $('#phone').val(data.phone);
            $('#phone').parent('span').addClass('input--filled');
            $('#address').val(data.address);
            $('#address').parent('span').addClass('input--filled');
            if (data.desc) {
                $('#desc').val(data.desc);
                $('#desc').parent('span').addClass('input--filled');
            }
        })
        //上传图片
        $("#filePerson").on("change", function () {
            $('form').ajaxForm({
                success: function(data) {
                    $("#personPhoto").attr("src",data);
                    $("#avatarImgSrc").val(data);
                },
            }).submit();
        });
//        修改
        $('#savePerson').on('click', function () {
            var data = {};
            data.upwd = $('#password').val();
            data.nick = $('#nick').val();
            data.phone = $('#phone').val();
            data.email = $('#email').val();
            data.address = $('#address').val();
            data.desc = $('#desc').val();
            data.imgSrc = $("#avatarImgSrc").val();
            $.post("/userUpdate",data,function(data){
                if(msg = 'OK') {
                    alert('个人信息修改成功');
                    location.href = "/home";
                }
            })
        })

    })
</script>

</body>
</html>

