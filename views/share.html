
<!DOCTYPE html>
<html class="no-js">
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title><%= title %></title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Template by FREEHTML5" />
	<meta name="keywords" content="free html5, free template, free bootstrap, html5, css3, mobile first, responsive" />
	

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="favicon.ico">
	<!-- Google Fonts -->
	<link href='http://fonts.googleapis.com/css?family=Playfair+Display:400,700,400italic|Roboto:400,300,700' rel='stylesheet' type='text/css'>
	<!-- Animate -->
	<link rel="stylesheet" href="stylesheets/animate.css">
	<!-- Icomoon -->
	<link rel="stylesheet" href="stylesheets/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="stylesheets/bootstrap.min.css">

	<link rel="stylesheet" href="stylesheets/style2.css">

	<link rel="stylesheet" href="stylesheets/style.css">

	<link rel="stylesheet" href="stylesheets/input.css">
	<!-- <link rel="stylesheet" href="stylesheets/component.css"> -->


	<!-- Modernizr JS -->
	<script src="javascripts/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->
	<style>
		*{ margin: 0; padding: 0;}
		.uploadCover { position: absolute; width: 100px; top: 0; left: 50%; margin-left: -50px; opacity: 0; }
		.classifyTitle { color: #6a7989; font-size: 80%; font-weight: bold; padding-left: 5px; }
		.select-list { position: relative; font-size: 16px; color: #595F6E; box-sizing: border-box; display: inline-block; margin: 0 0 20px 30px;}
		.select-list .select-value { line-height: 30px; width: 200px; border: 2px solid #ddd; position: relative; padding-left: 10px; display: inline-block; }
		.select-list .select-option { position: absolute; top: 34px; left: 0; list-style: none; width: 100%; border: 2px solid #ddd; border-top: none; display: none;}
		.select-list .select-option li { padding: 5px 10px; }
		.select-list .select-option li:hover, .selected { background-color: #f7c873; color: #fff; }
		.select-list i { position: absolute; right: 5px; top: 0; line-height: 30px;}
		.coverUrl { max-width: 300px; max-height: 300px; margin-top: 20px;}
	</style>
	</head>
	<body>
	<!-- END #fh5co-offcanvas -->
	<header id="fh5co-header">
		
		<div class="container-fluid">

			<div class="row">
				<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
				<div class="col-lg-12 col-md-12 text-center">
					<h1 id="fh5co-logo"><a href="home">我要分享</a></h1>
				</div>

			</div>
		
		</div>

	</header>
    <div class="copyrights">Collect from <a href="http://www.cssmoban.com/" >企业网站模板</a></div>
	<!-- END #fh5co-header -->
	<div class="container-fluid">
		<div class="row fh5co-post-entry" style = 'width:40%; margin: 0 auto'>
			<div class = '' style = 'font-size:20px'>
				<span class="input input--hoshi" style = 'text-align: center; margin-bottom: 30px'>
					<a><i class = 'glyphicon glyphicon-upload'></i>上传封面</a></br>
					<form enctype="multipart/form-data">
						<input type = 'file' class = 'uploadCover' name = 'cover'/>
					</form>
					<input type = 'hidden' value = '' class = 'hiddUrl' />
					<img class = 'coverUrl' src = '' alt = '' />
				</span>
				<span>
					<span class="classifyTitle">分类</span>
					<div class = 'select-list'>
						<p class = 'select-value'>文学<i class = 'glyphicon glyphicon-chevron-down'></i></p>
						<ul class = 'select-option'>
							<li class = 'selected'>文学</li>
							<li>历史</li>
						</ul>
					</div>
				</span>
				<span class="input input--hoshi">
					<input class="input__field input__field--hoshi title" type="text" id="input-4" />
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="input-4">
						<span class="input__label-content input__label-content--hoshi">书名</span>
					</label>
				</span>	
				<span class="input input--hoshi">
					<input class="input__field input__field--hoshi author" type="text" id="input-4" />
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="input-4">
						<span class="input__label-content input__label-content--hoshi">作者</span>
					</label>
				</span>	
				<span class="input input--hoshi">
					<textarea class="input__field input__field--hoshi desc" type="text" id="input-4" required rows='5' style = 'resize: none'></textarea>
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="input-4">
						<span class="input__label-content input__label-content--hoshi">简介</span>
					</label>
				</span>
				<span class="input input--hoshi">
					
					<label class="input__label input__label--hoshi input__label--hoshi-color-1" for="input-4">
						<span class="input__label-content input__label-content--hoshi">备注</span>
					</label>
					<input class="input__field input__field--hoshi" type="text" id="input-4 ps" />
				</span>
				<div style = 'text-align: right'><a id = 'toShare'><i class  = 'glyphicon glyphicon-share-alt' style = 'font-size: 120%; width: 30px'></i>分享</a></div>
			</div>
		</div>

	</div>

	<footer id="fh5co-footer">
		<p><small>&copy; 2016. Magazine Free HTML5. All Rights Reserverd. <br> More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a></small></p>
	</footer>


	
	<!-- jQuery -->
	<script src="javascripts/jquery-1.11.1.min.js"></script>
	<!-- jQuery Easing -->
	<script src="javascripts/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="javascripts/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="javascripts/jquery.waypoints.min.js"></script>
	<!-- Main JS -->
	<script src="javascripts/main.js"></script>

	<script src="javascripts/home.js"></script>

	<script src="javascripts/input.js"></script>

	<script src="javascripts/jquery-form.js"></script>

	<script>
		$(document).ready(function() {
			$.ajax({
				url: '/categoryList', 
				type: 'get'
			}).done((data) => {
				var data = JSON.parse(data);
				var html = createCategoryList(data);
				$('.select-option').html(html);
			})

			function createCategoryList(data) {
				var html = '';
				$.each(data, function(index, item) {
					if(index == 0) {
						html += "<li class = 'selected' categoryId = '" + item._id + "'>" + item.name + "</li>";
					}else {
						html += "<li categoryId = '" + item._id + "'>" + item.name + "</li>";
					}
				});
				return html;
			};

			$('.uploadCover').on('change', function() {
				$('form').ajaxForm({
					url: '/coverUpload',
					type: 'post',
					success: function(url) {
						$('.coverUrl').attr('src', url);
						$('.hiddUrl').val(url);
					}
				}).submit();
			})
			$(document).on('click', function(event) {
				var target = event.target || window.event.target;
				if($(target).parents('div').hasClass('select-list')) {
					$('.select-option').slideDown();
					if(target.nodeName == 'LI') {
						$('.select-option li').removeClass('selected');
						$(target).addClass('selected');
						$('.select-option').slideUp();
					}
				}else {
					$('.select-option').slideUp();
				}
			});

			$('#toShare').on('click', function() {
				var data = {};
				data.title = $('.title').val();
				data.author = $('.author').val();
				data.desc = $('.desc').val();
				data.imgSrc = $('input[type="hidden"]').val();
				data.categoryId = $('.select-option .selected').attr('categoryId');
				$.ajax({
					url: '/bookShare',
					type: 'post',
					data: data
				}).done((data) => {
					console.log(data);
				});
			})
		});
	</script>

	</body>
</html>

